<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.or.kosta.dao.OrderDao">
	<!-- 주문 리스트 구하기 -->
   	<select id="getCompletedOrder" resultType="kr.or.kosta.dto.Order">
		select orderNum, mo.id, price, menu, orderStartTime, orderCompleteTime
		, orderComplete, branchCode, deliveryNum, m.phoneNum
		from memberorder mo ,member m 
		where mo.id = m.id and branchCode=#{branchCode}
		order by mo.orderComplete asc , mo.orderNum desc 
	</select>  
<!--    	<select id="getCompletedOrder" resultType="kr.or.kosta.dto.Order">
		select *
		from(
		select rownum rn, orderNum, mo.id, price, menu, orderStartTime, orderCompleteTime
		, orderComplete, branchCode, deliveryNum, m.phoneNum
		from memberorder mo ,member m 
		where mo.id = m.id and branchCode=#{param1}
		order by mo.orderComplete asc , mo.orderNum desc 
		) where rn between #{param2} and #{param2} 
		
	</select> -->
	<!-- 총 인원수 구하기 -->
	<select id="getCount" resultType="Integer">
		select count(*) cnt
		from memberorder
	</select>
	
	<update id="completeOrder">
		update memberorder
		set orderComplete=1, orderCompleteTime=sysdate
		where branchCode=#{param1} and orderNum=#{param2}
	</update>
</mapper>